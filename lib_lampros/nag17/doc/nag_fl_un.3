.SH "Name"
nag_fl_un \- NAG Fortran Library, Mark 17, Users' Note

.TH "Users' Note" "3NAG" "" "Fortran Library"

.B "                 NAG Fortran Library, Mark 17
 
.B "                          FLIB617DA
 
.B "             IBM RISC System/6000 Double Precision
 
.B "                         Users' Note
 
 
.SH "Introduction"
 
This document is essential reading for every user of the NAG Fortran Library
Implementation specified in the title. It provides implementation-specific
detail that augments the information provided in the NAG Fortran Library Manual
and Introductory Guide. Wherever those manuals refer to the "Users' Note for
your implementation", the user should consult this note. 
 
NAG recommends that users read the following minimum reference material before
calling any library routine: 
 
.in +5
.ti -4
(a) Essential Introduction
.ti -4
(b) Chapter Introduction
.ti -4
(c) Routine Document
.ti -4
(d) Implementation-specific Users' Note
.in -5
 
Items (a), (b) and (c) are included in the NAG Fortran Library Manual; items
(a) and (b) are also included in the NAG Fortran Library Introductory Guide;
item (d) is this document which is provided in man page form. 
Items (a) and (d) are also supplied on the distribution medium. Each NAG
Fortran Library site is supplied with at least one copy of each of the above.
Please ask your NAG Site Contact for further information. 
 
.SH "Availability of Routines"
 
All routines listed in the chapter contents documents of the NAG Fortran
Library Manual, Mark 17 are available in this implementation. At Mark 17, 43
new primary ('user-callable') routines have been introduced, and 25 deleted.
Please consult the document FORTRAN MARK 17 NEWS in the manual for lists of
these routines and for a list of routines scheduled for withdrawal at Mark 18
or later. The file doc/news supplied to your site on the library 
distribution medium (see the section "User Documentation" below) also gives an 
outline of the new material available. 
 
.SH "General Information"
 
.SS "Accessing the Library"

Assuming that libnag.a has been installed in /usr/local/lib or /usr/lib, 
then a user may link to the NAG Fortran Library in the following manner:

xlf driver.f -lnag

where driver.f is the user's application program.

The driver program (and the NAG library) will use the AIX Basic Linear
Algebra Subprograms (BLAS) library if it is linked in the following manner:

xlf driver.f -lblas -lnag

The driver program (and the NAG library) will use the IBM Engineering and
Scientific Subroutine Library (ESSL) and AIX BLAS library if it is linked
in the following manner:

xlf driver.f -lessl -lblas -lnag

If the underscore appended library (libnag_u.a, all routines compiled with
the -qextname compiler option) has been installed, then a user may link to
it in the following manner:

xlf driver.f -qextname -lnag_u

The underscore appended library is supplied to ease the porting of C
programs which call the NAG Fortran Library from systems which use this
convention to AIX. This variant of the library may not be included in
future marks of this implementation. Please contact NAG if you wish it to
be included.

If the shareable forms of the NAG Fortran Library have been installed, then
a user may link to them with one of the following commands:

xlf driver.f -lnag_sh

xlf driver.f -lblas -lnag_b_sh

xlf driver.f -lessl -lblas -lnag_e_sh

xlf driver.f -qextname -lnag_u_sh
 
.SS "Interpretation of Bold Italicised Terms"
 
For this double precision implementation, the bold italicised terms used in
the NAG Fortran Library Manual (and shown here as //.....// ) should be
interpreted as: 
 
.nf
//real//                 - DOUBLE PRECISION (REAL*8)
//basic precision//      - double precision
//complex//              - COMPLEX*16
//additional precision// - quadruple precision (REAL*16)
//machine precision//    - the machine precision, see the value
                           returned by X02AJF in the section 
                           "Routine-specific Information" below
.fi
 
Thus a parameter described as //real// should be declared as DOUBLE 
PRECISION in the user's program. If a routine accumulates an inner product 
in //additional precision//, it is using software to simulate quadruple 
precision.
 
In routine documents that have been newly typeset since Mark 12 additional bold
italicised terms are used in the published example programs and they must be
interpreted as follows: 

.nf 
//real// as an intrinsic function name - DBLE
//imag//                               - DIMAG
//cmplx//                              - DCMPLX
//conjg//                              - DCONJG
//e// in constants, e.g. 1.0//e//-4    - D, e.g. 1.0D-4
//e// in formats, e.g. //e//12.4       - D, e.g. D12.4
.fi
 
All references to routines in Chapter F07 - Linear Equations (LAPACK) and
Chapter F08 - Least-squares and Eigenvalue Problems (LAPACK) use the LAPACK
name, not the NAG F07/F08 name. The LAPACK name is precision dependent, and
hence the name appears in a bold italicised typeface. 

The typeset examples use the single precision form of the LAPACK name. To
convert this name to its double precision form, change the first character 
either from S to D or C to Z as appropriate.
For example:

.nf 
//sgetrf// refers to the LAPACK routine name - DGETRF
//cpotrs//                                   - ZPOTRS
.fi
 
.SS "Example Programs"
 
In the NAG Fortran Library Manual, routine documents that have been typeset
since Mark 12 present the example programs in a generalised form, using bold
italicised terms as described in the section "Interpretation of Bold Italicised 
Terms" above. 
 
In other routine documents, the example programs are in single precision and
require modification for use with double precision routines. This conversion
can entail:

.nf
- Changing REAL or COMPLEX type specifications to REAL*8 or 
  COMPLEX*16

- Changing certain intrinsic function references, e.g. REAL or FLOAT 
  to DBLE, ALOG to DLOG, CMPLX to DCMPLX, and so on

- Changing real constants to double precision form, e.g. 0.1 or 0.1E0 
  to 0.1D0
.fi

The example programs supplied to a site in machine-readable form have been
modified as necessary so that they are suitable for immediate execution. Note
that all the distributed example programs have been revised and do not
correspond exactly with the programs published in the manual, unless the
documents have been recently typeset. The distributed example programs should
be used in preference wherever possible. 
 
The example programs are most easily accessed by the command nagexample, 
which will provide you with a copy of an example program (and its data, if
any), compile the program and link it with the library (showing you the 
compile command so that you can recompile your own version of the program). 
Finally, the executable program will be run, presenting its output to 
stdout. The example program concerned is specified by the argument to 
nagexample, which should be the name of a NAG Fortran Library routine, e.g.

nagexample c02aff

will copy the example program and its data into the files c02affe.f and 
c02affe.d in the current directory and process them to produce the example
program results.

.SS "Explicit Output from NAG Routines"
 
Certain routines produce explicit error messages and advisory messages via
output units which either have default values or can be reset by using X04AAF
for error messages and X04ABF for advisory messages. (The default values are
given in the section "Routine-specific Information" below). The maximum record 
lengths of error messages and advisory messages (including carriage control 
characters) are 80 characters, except where otherwise specified. 
 
.SS "User Documentation"
 
The following information is provided in man page form:

nag_fl_un.3 - Users' Note (this document)

The following machine-readable information files are provided by NAG on the
library distribution medium. Please consult your local advisory service or NAG
Site Contact for further details: 
 
.nf
essint   - the Essential Introduction to the NAG Fortran Library
summary  - a brief summary of the routines
news     - an outline of the new and enhanced routines available at 
           Mark 17
replaced - a list of routines available at earlier Marks of the 
           Library but since withdrawn, together with recommended 
           replacements
calls    - a list of routines called directly or indirectly by each
           routine in the library, and by each example program
called   - for each routine in the library (including auxiliaries), a 
           list of routines and example programs which call it 
           directly or indirectly
.fi
 
See the section "Additional Services from NAG" below for additional 
documentation available from NAG.
 
.SH "Routine-specific Information"
 
Any further information which applies to one or more routines in this
implementation is listed below, chapter by chapter. 

.ti -4
(a) F06, F07 and F08

In this implementation calls to some of the Basic Linear Algebra 
Subprograms (BLAS) and linear algebra routines (LAPACK) can be resolved by 
calls to the AIX BLAS library or the IBM Engineering and Scientific 
Subroutine Library (ESSL) (see the section "Accessing the Library" above).

.ti -4
(b) G02
 
The value of ACC, the machine-dependent constant mentioned in several documents
in the chapter, is 1.0D-13.

.ti -4 
(c) P01
 
On hard failure, P01ABF writes the error message to the error message unit 
specified by X04AAF and then stops.
 
.ti -4
(d) S07 - S21
 
The constants referred to in the NAG Fortran Library Manual have the following
values in this implementation: 
 
.nf
.in +4
S07AAF  F(1)   = 1.0D+13
        F(2)   = 1.0D-14

S10AAF  E(1)   = 18.50
S10ABF  E(1)   = 708.0
S10ACF  E(1)   = 708.0

S13AAF  x(hi)  = 708.3
S13ACF  x(hi)  = 1.0D+16
S13ADF  x(hi)  = 1.0D+17

S14AAF  IFAIL  = 1 if X > 170.0
        IFAIL  = 2 if X < -170.0
        IFAIL  = 3 if abs(X) < 2.23D-308
S14ABF  IFAIL  = 2 if X > 2.55D+305

S15ADF  x(hi)  = 26.6
        x(low) = -6.25
S15AEF  x(hi)  = 6.25
 
S17ACF  IFAIL  = 1 if X > 1.0D+16
S17ADF  IFAIL  = 1 if X > 1.0D+16
        IFAIL  = 3 if 0.0 < X <= 2.23D-308
S17AEF  IFAIL  = 1 if abs(X) > 1.0D+16
S17AFF  IFAIL  = 1 if abs(X) > 1.0D+16
S17AGF  IFAIL  = 1 if X > 103.8
        IFAIL  = 2 if X < -5.6D+10
S17AHF  IFAIL  = 1 if X > 104.1
        IFAIL  = 2 if X < -5.6D+10
S17AJF  IFAIL  = 1 if X > 104.1
        IFAIL  = 2 if X < -1.8D+9
S17AKF  IFAIL  = 1 if X > 104.1
        IFAIL  = 2 if X < -1.8D+9
S17DCF  IFAIL  = 2 if abs (Z) < 3.93D-305
        IFAIL  = 4 if abs (Z) or FNU+N-1 > 3.27D+4
        IFAIL  = 5 if abs (Z) or FNU+N-1 > 1.07D+9
S17DEF  IFAIL  = 2 if imag (Z) > 700.0
        IFAIL  = 3 if abs (Z) or FNU+N-1 > 3.27D+4
        IFAIL  = 4 if abs (Z) or FNU+N-1 > 1.07D+9
S17DGF  IFAIL  = 3 if abs (Z) > 1.02D+3
        IFAIL  = 4 if abs (Z) > 1.04D+6
S17DHF  IFAIL  = 3 if abs (Z) > 1.02D+3
        IFAIL  = 4 if abs (Z) > 1.04D+6
S17DLF  IFAIL  = 2 if abs (Z) < 3.93D-305
        IFAIL  = 4 if abs (Z) or FNU+N-1 > 3.27D+4
        IFAIL  = 5 if abs (Z) or FNU+N-1 > 1.07D+9

S18ADF  IFAIL  = 2 if 0.0 < X <= 2.23D-308
S18AEF  IFAIL  = 1 if abs(X) > 711.6
S18AFF  IFAIL  = 1 if abs(X) > 711.6
S18CDF  IFAIL  = 2 if 0.0 < X <= 2.23D-308
S18DCF  IFAIL  = 2 if abs (Z) < 3.93D-305
        IFAIL  = 4 if abs (Z) or FNU+N-1 > 3.27D+4
        IFAIL  = 5 if abs (Z) or FNU+N-1 > 1.07D+9
S18DEF  IFAIL  = 2 if real (Z) > 700.0
        IFAIL  = 3 if abs (Z) or FNU+N-1 > 3.27D+4
        IFAIL  = 4 if abs (Z) or FNU+N-1 > 1.07D+9
 
S19AAF  IFAIL  = 1 if abs(x) >= 49.50
S19ABF  IFAIL  = 1 if abs(x) >= 49.50
S19ACF  IFAIL  = 1 if X > 997.26
S19ADF  IFAIL  = 1 if X > 997.26

S21BCF  IFAIL  = 3 if an argument < 1.579D-205
        IFAIL  = 4 if an argument >= 3.774D+202
S21BDF  IFAIL  = 3 if an argument < 2.820D-103
        IFAIL  = 4 if an argument >= 1.404D+102
.in -4
.fi
 
.ti -4
(e) X01
 
The values of the mathematical constants are:
 
.nf
.in +4
X01AAF (PI)    = 3.1415926535897932
X01ABF (GAMMA) = 0.5772156649015329
.in -4
.fi

.ti -4 
(f) X02
 
The values of the machine constants are:
 
The basic parameters of the model
 
.nf
.in +4
X02BHF = 2
X02BJF = 53
X02BKF = -1021
X02BLF = 1024
X02DJF = .TRUE.
 
.ti -4
Derived parameters of floating-point arithmetic
 
X02AJF = Z'3CA0000000000001' ( 1.11022302462516D-16 )
X02AKF = Z'0010000000000000' ( 2.22507385850721D-308 )
X02ALF = Z'7FEFFFFFFFFFFFFF' ( 1.79769313486231D+308 )
X02AMF = Z'0010000000000000' ( 2.22507385850721D-308 )
X02ANF = Z'0010000000000000' ( 2.22507385850721D-308 )
 
.ti -4
Parameters of other aspects of the computing environment

X02AHF = Z'4690000000000000' ( 8.11296384146067D+31 )
X02BBF = 2147483647
X02BEF = 15
X02DAF = .FALSE.
.in -4
.fi
 
.ti -4
(g) X04
 
The default output units for error and advisory messages for those routines
which can produce explicit output are both Fortran Unit 6.
 
.SH "Additional Services from NAG"
 
.ti -4
(a) Printed Manuals
 
Where a manual has been provided as part of the contract issue, this manual is
updated automatically at each new release of the software, by the supply of a
manual update set or a complete new manual. If additional manuals have been
ordered in the past then updates to these manuals may be ordered separately.
They are NOT sent automatically. Additional complete manuals and the manual
updates (where relevant) are available at prices published in the NAG
documentation order form. 

.ti -4 
(b) On-line Information Supplement
 
To complement the manuals NAG produces an On-line Information Supplement which
fulfils two roles: 

.nf 
- it gives keyword-driven guidance on the selection of the 
  appropriate NAG routine
- it gives abbreviated on-line documentation of the NAG routines, to 
  enable the user to call the routines and investigate any IFAIL 
  messages without recourse to the manual
.fi
 
.SH "Support from NAG"
 
.ti -4
(a) Contact with NAG
 
Queries concerning this document or the implementation generally should be
directed initially to your local Advisory Service. If you have difficulty in
making contact locally, you can write to NAG directly, at one of the supplied
addresses. Users subscribing to the support service are encouraged to contact
one of the NAG Response Centres (see below). 
 
.ti -4
(b) NAG Response Centres
 
The NAG Response Centres are available for general enquiries from all users and
also for technical queries from sites with an annually licensed product or
support service. 
 
The Response Centres are open during office hours, but contact is possible by
fax, email and phone (answering machine) at all times. 
 
When contacting a Response Centre please quote your NAG user reference and NAG
product code. 

.ti -4 
(c) Network
 
Network, NAG's newsletter, is produced quarterly and sent free of charge to
sites with a supported product or service. 
 
.ti -4 
(d) NAG Bulletin Board

The NAG Bulletin Board is an information service providing items of interest to
users and prospective users of NAG products and services. The information is
regularly updated and reviewed and includes implementation availability,
descriptions of products, downloadable software and technical reports. The
bulletin board can be contacted using Gopher 

.nf
Host=www.nag.co.uk, Port=70, Type=1, Path=1/
.fi

or WWW

.nf
http://www.nag.co.uk/
.fi
 
.SH "NAG Users Association"
 
NAGUA, the NAG Users Association, is a self-financing, non-profitmaking body.
It exists to promote communications between NAG and users of its products and
services. It provides information to NAG on the requirements of users, who are
in turn kept informed of developments in services. Membership is available to
any institution or individual holding a licence for any NAG product or service.
 
Members receive discounts on the registration fees at conferences and
workshops. Members also receive 'NAGUA News', NAGUA's own newsletter. 
 
For an information pack and membership application form, please contact NAGUA
at the supplied address. 
 
 
.SH "Appendix - supplied addresses"

.nf 
NAG Ltd
Wilkinson House
Jordan Hill Road
OXFORD  OX2 8DR                         NAG Ltd Response Centre
United Kingdom                          email: infodesk@nag.co.uk
 
Tel: +44 1865 511245                    Tel: +44 1865 311744
Fax: +44 1865 310139                    Fax: +44 1865 311755
 
NAG Inc
1400 Opus Place, Suite 200
Downers Grove
IL 60515-5702                           NAG Inc Response Center
USA                                     email: infodesk@nag.com
 
Tel: +1 708 971 2337                    Tel: +1 708 971 2345
Fax: +1 708 971 2706                    Fax: +1 708 971 2346
 
NAG GmbH
Schleissheimerstrasse 5
D-85748 Garching
Germany
 
Tel: +49 89 3207395
Fax: +49 89 3207396
 
 
 
NAG Users Association
PO Box 426
OXFORD  OX2 8SD
United Kingdom
email: nagua@nag.co.uk
 
Tel: +44 1865 311102
